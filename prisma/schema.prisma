generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["views"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id        String   @id @unique @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  firstName String?
  lastName  String?
  email     String?  @unique
  image     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
  profile   Profile?
}

model Profile {
  id                String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  userType          UserType?
  userId            String        @db.Uuid @unique
  bio               String?
  locationId        Int?
  occupationId      Int?
  updatedAt         DateTime      @default(now())
  gender            Gender?
  sameGenderPref    Boolean?
  isComplete        Boolean       @default(false)
  linkedInUrl       String?
  githubUrl         String?
  buyMeCoffeeUrl    String?
  yearsOfExperience Int?
  calendlyUserUri   String?       @unique
  location          Location?     @relation(fields: [locationId], references: [id])
  occupation        Occupation?   @relation(fields: [occupationId], references: [id])
  user              User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  calendlyUser      CalendlyUser?
}

model Location {
  id      Int       @id @default(autoincrement())
  city    String?
  country String?
  profile Profile[]

  @@unique([city, country])
}

model Occupation {
  id                Int       @id @default(autoincrement())
  role              String?
  company           String?
  profile           Profile[]

  @@unique([role, company])
}

model CalendlyUser {
  uri                  String   @id
  profileId            String   @db.Uuid @unique
  name                 String?
  slug                 String?
  email                String?
  scheduling_url       String?  @unique
  timezone             String?
  avatar_url           String?
  created_at           DateTime @default(now())
  updated_at           DateTime @default(now())
  current_organization String?
  resource_type        String?
  profile              Profile  @relation(fields: [profileId], references: [id], onDelete: Cascade)
}

view MentorProfile {
  id                    String    @unique
  userType              UserType?
  firstName             String?
  lastName              String?
  bio                   String?
  image                 String?
  calendlySchedulingUrl String?
  gender                Gender?
  sameGenderPref        Boolean?
  city                  String?
  country               String?
  role                  String?
  yearsOfExperience     Int?
  company               String?
  linkedInUrl           String?
  githubUrl             String?
  buyMeCoffeeUrl        String?
}

enum UserType {
  MENTOR
  MENTEE
}

enum Gender {
  MALE
  FEMALE
}
